datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model PendingUser {
  id                    String   @id @default(auto()) @map("_id") @db.ObjectId
  //
  email                 String   @unique
  //
  officialName          String
  officialSurname       String
  //
  displayName           String?
  displaySurname        String?
  //
  password              String
  //
  dateOfBirth           String
  //
  timeCreated           DateTime @default(now())
  emailVerificationCode String
}

model User {
  id                            String                                     @id @default(auto()) @map("_id") @db.ObjectId
  //
  showPhoneNumber               Boolean                                    @default(false)
  allowMessagesFromEveryone     Boolean                                    @default(false) @map("amfe")
  createdAt                     DateTime                                   @default(now())
  password                      String                                     @map("pw")
  userNumber                    String                                     @unique
  username                      String?                                    @unique
  //
  profileVisibility             Int                                        @default(5)
  organiserProfileVisibility    Int                                        @default(2)
  //
  email                         String                                     @unique
  phoneNumber                   String                                     @default("")
  //
  bio                           String                                     @default("")
  //
  officialName                  String
  officialSurname               String
  //
  displayName                   String?
  displaySurname                String?
  //
  nationality                   String?
  dateOfBirth                   DateTime                                   @map("dob")
  pronoun1                      String?                                    @default("")
  pronoun2                      String?                                    @default("")
  //
  member                        Member[]
  delegate                      Delegate[]
  schoolStudent                 SchoolStudent[]
  schoolDirector                SchoolDirector[]
  chair                         Chair[]
  manager                       Manager[]
  AssignedBy                    Task[]                                     @relation("assigned_by")
  AssignedTo                    Task[]                                     @relation("assigned_to")
  rollCall                      RollCall[]
  globalAdmin                   GlobalAdmin[]
  seniorDirecor                 SeniorDirector[]
  secretaryGeneral              SecretariatSecretaryGeneral[]
  presidentOfTheGeneralAssembly SecretariatPresidentOfTheGeneralAssembly[]
  deputySecretaryGeneral        SecretariatDeputySecretaryGeneral[]
}

model Session {
  id                            String                                     @id @default(auto()) @map("_id") @db.ObjectId
  //
  isCurrent                     Boolean                                    @default(false)
  number                        Int                                        @unique
  //
  theme                         String                                     @default("")
  explanation                   String                                     @default("")
  //
  committee                     Committee[]
  delegate                      Delegate[]
  chair                         Chair[]
  member                        Member[]
  manager                       Manager[]
  schoolDirector                SchoolDirector[]
  workshopDay                   WorkshopDay[]
  conferenceDay                 ConferenceDay[]
  task                          Task[]
  secretaryGeneral              SecretariatSecretaryGeneral[]
  presidentOfTheGeneralAssembly SecretariatPresidentOfTheGeneralAssembly[]
  deputySecretaryGeneral        SecretariatDeputySecretaryGeneral[]
  team                          Team[]
}

model GlobalAdmin {
  id     String @id @default(auto()) @map("_id") @db.ObjectId
  //
  user   User   @relation(fields: [userId], references: [id])
  userId String @db.ObjectId
}

model SeniorDirector {
  id     String @id @default(auto()) @map("_id") @db.ObjectId
  //
  user   User   @relation(fields: [userId], references: [id])
  userId String @db.ObjectId
}

model SecretariatSecretaryGeneral {
  id        String  @id @default(auto()) @map("_id") @db.ObjectId
  user      User    @relation(fields: [userId], references: [id])
  userId    String  @db.ObjectId
  session   Session @relation(fields: [sessionId], references: [id])
  sessionId String  @db.ObjectId
}

model SecretariatPresidentOfTheGeneralAssembly {
  id        String  @id @default(auto()) @map("_id") @db.ObjectId
  user      User    @relation(fields: [userId], references: [id])
  userId    String  @db.ObjectId
  session   Session @relation(fields: [sessionId], references: [id])
  sessionId String  @db.ObjectId
}

model SecretariatDeputySecretaryGeneral {
  id        String  @id @default(auto()) @map("_id") @db.ObjectId
  user      User    @relation(fields: [userId], references: [id])
  userId    String  @db.ObjectId
  session   Session @relation(fields: [sessionId], references: [id])
  sessionId String  @db.ObjectId
}

model ConferenceDay {
  id          String     @id @default(auto()) @map("_id") @db.ObjectId
  //
  name        String?
  //
  startDate   DateTime
  endDate     DateTime
  //
  description String     @default("")
  //
  location    Location?  @relation(fields: [locationId], references: [id])
  locationId  String?    @db.ObjectId
  //
  session     Session    @relation(fields: [sessionId], references: [id])
  sessionId   String     @db.ObjectId
  //
  rollCall    RollCall[]
}

model WorkshopDay {
  id          String     @id @default(auto()) @map("_id") @db.ObjectId
  //
  name        String?
  //
  startDate   DateTime
  endDate     DateTime
  //
  description String
  //
  location    Location?  @relation(fields: [locationId], references: [id])
  locationId  String?    @db.ObjectId
  //
  session     Session    @relation(fields: [sessionId], references: [id])
  sessionId   String     @db.ObjectId
  //
  rollCall    RollCall[]
}

model RollCall {
  id              String         @id @default(auto()) @map("_id") @db.ObjectId
  //
  user            User           @relation(fields: [userId], references: [id])
  userId          String         @db.ObjectId
  //
  status          Int            @default(0)
  //
  workshopDay     WorkshopDay?   @relation(fields: [workshopDayId], references: [id])
  workshopDayId   String?        @db.ObjectId
  //
  conferenceDay   ConferenceDay? @relation(fields: [conferenceDayId], references: [id])
  conferenceDayId String?        @db.ObjectId
}

model School {
  id             String           @id @default(auto()) @map("_id") @db.ObjectId
  //
  name           String           @unique
  slug           String?          @unique
  joinYear       Int?
  //
  Location       Location?        @relation(fields: [locationId], references: [id])
  locationId     String?          @db.ObjectId
  //
  SchoolMember   SchoolStudent[]
  SchoolDirector SchoolDirector[]
}

model SchoolStudent {
  id       String @id @default(auto()) @map("_id") @db.ObjectId
  //
  user     User   @relation(fields: [userId], references: [id])
  userId   String @db.ObjectId
  //
  school   School @relation(fields: [schoolId], references: [id])
  schoolId String @db.ObjectId
}

model SchoolDirector {
  id        String  @id @default(auto()) @map("_id") @db.ObjectId
  //
  user      User    @relation(fields: [userId], references: [id])
  userId    String  @db.ObjectId
  //
  school    School  @relation(fields: [schoolId], references: [id])
  schoolId  String  @db.ObjectId
  //
  session   Session @relation(fields: [sessionId], references: [id])
  sessionId String  @db.ObjectId
}

model Committee {
  id          String     @id @default(auto()) @map("_id") @db.ObjectId
  //
  name        String
  description String     @default("")
  //
  session     Session    @relation(fields: [sessionId], references: [id])
  sessionId   String     @db.ObjectId
  //
  delegate    Delegate[]
  chair       Chair[]
}

model Delegate {
  id          String    @id @default(auto()) @map("_id") @db.ObjectId
  country     String?
  //
  user        User      @relation(fields: [userId], references: [id])
  userId      String    @db.ObjectId
  //
  committee   Committee @relation(fields: [committeeId], references: [id])
  committeeId String    @db.ObjectId
  //
  session     Session   @relation(fields: [sessionId], references: [id])
  sessionId   String    @db.ObjectId
}

model Chair {
  id          String    @id @default(auto()) @map("_id") @db.ObjectId
  //
  user        User      @relation(fields: [userId], references: [id])
  userId      String    @db.ObjectId
  //
  committee   Committee @relation(fields: [committeeId], references: [id])
  committeeId String    @db.ObjectId
  //
  session     Session   @relation(fields: [sessionId], references: [id])
  sessionId   String    @db.ObjectId
}

model Team {
  id          String    @id @default(auto()) @map("_id") @db.ObjectId
  //
  name        String
  description String    @default("")
  //
  session     Session   @relation(fields: [sessionId], references: [id])
  sessionId   String    @db.ObjectId
  //
  member      Member[]
  manager     Manager[]
}

model Member {
  id        String  @id @default(auto()) @map("_id") @db.ObjectId
  //
  job       String  @default("")
  //
  user      User    @relation(fields: [userId], references: [id])
  userId    String  @db.ObjectId
  //
  team      Team    @relation(fields: [teamId], references: [id])
  teamId    String  @db.ObjectId
  //
  session   Session @relation(fields: [sessionId], references: [id])
  sessionId String  @db.ObjectId
}

model Manager {
  id        String  @id @default(auto()) @map("_id") @db.ObjectId
  //
  user      User    @relation(fields: [userId], references: [id])
  userId    String  @db.ObjectId
  //
  team      Team    @relation(fields: [teamId], references: [id])
  teamId    String  @db.ObjectId
  //
  session   Session @relation(fields: [sessionId], references: [id])
  sessionId String  @db.ObjectId
}

model Location {
  id                   String          @id @default(auto()) @map("_id") @db.ObjectId
  //
  name                 String
  slug                 String?
  description          String?
  //
  street               String?
  city                 String?
  state                String?
  zipCode              String?
  country              String?
  //
  phone                String?
  email                String?
  website              String?
  //
  mapUrl               String?
  //
  School               School[]
  SessionConferenceDay ConferenceDay[]
  SessionWorkshopDay   WorkshopDay[]
}

model Task {
  id            String    @id @default(auto()) @map("_id") @db.ObjectId
  //
  name          String
  description   String    @default("")
  isCompleted   Boolean   @default(false)
  //
  assignedDate  DateTime  @default(now())
  dueDate       DateTime?
  completedDate DateTime?
  //
  assignedBy    User      @relation("assigned_by", fields: [assignedById], references: [id])
  assignedById  String    @db.ObjectId
  //
  assignedTo    User?     @relation("assigned_to", fields: [assignedToId], references: [id])
  assignedToId  String?   @db.ObjectId
  //
  session       Session   @relation(fields: [sessionId], references: [id])
  sessionId     String    @db.ObjectId
}

model TermsAndConditions {
  id      String @id @default(auto()) @map("_id") @db.ObjectId
  title   String
  content String
}
